#!/usr/bin/env sh

# SVN Revision Extractor for Unix systems
# Written by Burlex, 2008/02/20

revision=`LC_ALL=C svn info | grep Revision | cut -d' ' -f2`
if [ -z $revision ]; then
	revision=0
fi

echo "// This file was automatically generated by the SVN revision extractor." > src/ascent-shared/svn_revision.h
echo "// There is no need to modify it." >> src/ascent-shared/svn_revision.h
echo "#ifndef SVN_REVISION_H" >> src/ascent-shared/svn_revision.h
echo "#define SVN_REVISION_H" >> src/ascent-shared/svn_revision.h
echo >> src/ascent-shared/svn_revision.h
echo "static const char * BUILD_TAG = \"`cat ascent-tag`\";" >> src/ascent-shared/svn_revision.h
echo "static int BUILD_REVISION = $revision;" >> src/ascent-shared/svn_revision.h
echo >> src/ascent-shared/svn_revision.h
echo "#define BUILD_USER \"`whoami`\"" >> src/ascent-shared/svn_revision.h
echo "#define BUILD_WORKSTATION \"`uname -n`\"" >> src/ascent-shared/svn_revision.h
echo "#define SVN_DATE \"`date +%A,\ %B\ %d\ %Y`\"" >> src/ascent-shared/svn_revision.h
echo >> src/ascent-shared/svn_revision.h
echo "#define BUILD_TIME \"`date +%I:%M%p`\"" >> src/ascent-shared/svn_revision.h
echo "#define BUILD_DATE \"`date +%b\ %d\ %Y`\"" >> src/ascent-shared/svn_revision.h
echo >> src/ascent-shared/svn_revision.h
echo "#endif // SVN_REVISION_H" >> src/ascent-shared/svn_revision.h

echo "1"
